<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Prepare &#8212; iprPy 0.7.2 documentation</title>
    
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Runner" href="runner.html" />
    <link rel="prev" title="iprPy Classes" href="classes.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">iprPy 0.7.2 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="classes.html" title="iprPy Classes"
             accesskey="P">previous</a> |
          <a href="runner.html" title="Runner"
             accesskey="N">next</a> |
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="prepare">
<h1>Prepare<a class="headerlink" href="#prepare" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The first step in performing a calculation method in high-throughput is to
prepare instances of it. The process of preparing a calculation is that:</p>
<ol class="arabic">
<li><p class="first">All records in a database corresponding to the calculation’s record style
are accessed and collected into a table.</p>
</li>
<li><p class="first">Based on supplied parameter values, all meaningful combinations of
calculation input parameters are iterated over.</p>
</li>
<li><p class="first">Each iteration is compared to the table of existing calculations.</p>
</li>
<li><p class="first">If no match is found, then the corresponding calculation instance is
prepared by</p>
<blockquote>
<div><ol class="loweralpha simple">
<li>Creating a calculation folder in a run_directory</li>
<li>Copying the calculation script and any other required calculation files
to the run_directory.</li>
<li>Copying all required parent records from the database to the
run_directory.</li>
<li>Generating an input parameter file for the calculation using the
iteration parameters</li>
<li>Adding a corresponding incomplete calculation record to the database.</li>
</ol>
</div></blockquote>
</li>
</ol>
<p>Every single calculation style defines its own prepare function, which is
contained in a prepare_&lt;calcname&gt;.py script within the calculation style’s
directory. This is necessary as the meaningful combinations of input
parameters to iterate over are specific to a given calculation.</p>
<p><strong>Note</strong>: The table of existing records is only compiled once at the beginning
of the prepare method and the information associated with instances being
prepared are <em>not</em> appended.  Not updating the table makes preparing
noticeably faster, but also makes it possible that matching instances can end
up being prepared. To avoid this, there should never be more than one active
prepare operating on a specific calculation style at any time.</p>
</div>
<div class="section" id="notes-on-run-directory-naming">
<h2>Notes on run_directory naming<a class="headerlink" href="#notes-on-run-directory-naming" title="Permalink to this headline">¶</a></h2>
<p>The suggested manner of naming run_directories should be some combination of a
database name and a number of computational cores.  This is because prepared
calculation instances are associated with the database used to prepare them,
and runners can only access a single database and are limited by the number of
cores available.  For example, if your database is named &#8220;mydbase&#8221;, then
prepare serial calculations in a &#8220;mydbase1&#8221; run_directory and 4 core
calculations in a &#8220;mydbase4&#8221; run_directory.  How many processors that a
specific calculation instance will try to use should be given by one of the
input parameters for the prepare function and for the calculation.</p>
</div>
<div class="section" id="how-to-prepare">
<h2>How to prepare<a class="headerlink" href="#how-to-prepare" title="Permalink to this headline">¶</a></h2>
<p>Calculations can be prepared in one of three ways:</p>
<ol class="arabic simple">
<li>Use the inline iprPy prepare command.</li>
<li>Run a prepare Python script.</li>
<li>In Python, call the prepare method of a Calculation object.</li>
</ol>
<p>All three of these ways effectively do the same thing in that they access a
calculation’s prepare function. How they differ is in the handling of the
necessary inputs.</p>
<div class="section" id="inline-prepare">
<h3>Inline prepare<a class="headerlink" href="#inline-prepare" title="Permalink to this headline">¶</a></h3>
<p>Calculations can be prepared using the following inline iprPy terminal
command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">iprPy</span> <span class="n">prepare</span> <span class="o">&lt;</span><span class="n">database</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">run_directory</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">inputfile</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>&lt;database&gt; and &lt;run_directory&gt; are the names associated with a database and
run_directory that were defined using the iprPy set command.  &lt;inputfile&gt; is
the name/path to an input parameter file for the prepare command. When
preparing in this way, the input parameter file must contain a
“calculation_style” term that lists the calculation’s style.</p>
</div>
<div class="section" id="running-a-prepare-script">
<h3>Running a prepare script<a class="headerlink" href="#running-a-prepare-script" title="Permalink to this headline">¶</a></h3>
<p>The calculation’s prepare script can be executed directly from the calculation
style’s folder with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">prepare_</span><span class="o">&lt;</span><span class="n">calcname</span><span class="o">&gt;.</span><span class="n">py</span> <span class="o">&lt;</span><span class="n">inputfile</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Where &lt;calcname&gt; is the calculation style and &lt;inputfile&gt; is the name/path to
an input parameter file for the prepare command. When preparing in this way,
the input parameter file must contain a “run_directory” term, a “database”
term, and any extra “database_*” access terms defining the run_directory and
database to use.</p>
</div>
<div class="section" id="calculation-prepare-method">
<h3>Calculation.prepare() method<a class="headerlink" href="#calculation-prepare-method" title="Permalink to this headline">¶</a></h3>
<p>Within Python, a calculation can be prepared by initializing a Calculation
object, then calling the Calculation’s prepare method:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">calc</span> <span class="o">=</span> <span class="n">iprPy</span><span class="o">.</span><span class="n">Calculation</span><span class="p">(</span><span class="o">&lt;</span><span class="n">calcstyle</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">calc</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="o">&lt;</span><span class="n">dbase</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">run_directory</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, &lt;calcstyle&gt; is the Calculation style to use given as a string, &lt;dbase&gt;
is an iprPy.Database object, &lt;run_directory&gt; is the string path to a
run_directory, and kwargs are the calculation-specific parameters.  Most of
the kwargs correspond to the terms allowed in the input files used by the
inline prepare command and the prepare scripts. However, there can be
additional kwargs that provide more functionality and control than is allowed
by the other ways of preparing.</p>
</div>
</div>
<div class="section" id="prepare-parameters">
<h2>Prepare parameters<a class="headerlink" href="#prepare-parameters" title="Permalink to this headline">¶</a></h2>
<p>While the parameters used in preparing a calculation are specific to that
calculation, they can be classified into a few categories:</p>
<ul class="simple">
<li>Calculation parameters – These are parameters of the calculation that can be
directly assigned one or more values using correspondingly named prepare
parameters.</li>
<li>Limiting parameters – These are parameters that allow for limitations to be
used in iterating over the possible combinations. If a limiter is given,
then only the cases that correspond to the limiter’s values will be
included. If a limiter is not given, then there is no restriction placed
relative to the limiting parameter.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction to iprPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/index.html">iprPy Basics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">High-Throughput Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="classes.html">iprPy Classes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Prepare</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notes-on-run-directory-naming">Notes on run_directory naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-prepare">How to prepare</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#inline-prepare">Inline prepare</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-a-prepare-script">Running a prepare script</a></li>
<li class="toctree-l4"><a class="reference internal" href="#calculation-prepare-method">Calculation.prepare() method</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#prepare-parameters">Prepare parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="runner.html">Runner</a></li>
<li class="toctree-l2"><a class="reference internal" href="inline.html">Other High-Throughput Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis.html">Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extend/index.html">Adding Content to iprPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calculation_styles.html">Calculation Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../record_styles.html">Record Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../database_styles.html">Database Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">iprPy</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="classes.html" title="iprPy Classes"
              >previous</a> |
            <a href="runner.html" title="Runner"
              >next</a> |
            <a href="../py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../_sources/highthroughput/prepare.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Lucas Hale.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>